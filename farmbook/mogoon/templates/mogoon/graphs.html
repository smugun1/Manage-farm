{% extends 'mogoon/base.html' %}

{% load static %}


{% block title %}Graphs{% endblock %}

{% block body %}
<!--top-->

<div class="container bg-secondary align-items-center  my-4 p-4 border" style=" border-radius: 20px;">
    <div class="container md-12 bg-light align-items-center my-4 p-4 border" style=" border-radius: 20px;">
        <div class="container bg-white text-secondary my-1 px-1 py-1 mx-1 border" style=" border-radius: 20px;">
            <h1 class="text-center bg-secondary text-light">Graphs</h1>
            <p class="h2 text-center"></p>
            <div class="row my-1">
                <div class="container">
                    <div class="card">
                        <div class="card-header bg-light text-dark">
                            Graphs
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class=" col-md-4">
                                    <a class="text-decoration-none text-dark"
                                       href="{{ 'http:/127.0.0.1:8000/admin/' }}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h3>Recsources <i class="fa fa-leaf" aria-hidden="true"></i></h3>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-4">
                                    <a class="text-decoration-none text-dark"
                                       href="{% url 'reports' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h3>Go To Reports <i class="fa fa-leaf" aria-hidden="true"></i></h3>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark"
                                       href="{% url 'reports-update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter Reports <i class="fa fa-leaf" aria-hidden="true"></i></h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark" href="{% url 'employee-list_update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter Employees <i class="fa fa-bar-chart" aria-hidden="true"></i></h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark"
                                       href="{% url 'mogoon-green_table_update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter GreenLeaf <i class="fa fa-television" aria-hidden="true"></i>
                                            </h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark" href="{% url 'mogoon-purple_update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter PurpleLeaf <i class="fa fa-binoculars" aria-hidden="true"></i>
                                            </h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark"
                                       href="{% url 'mogoon-kandojobs_table_update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter Kandojobs <i class="fa-solid fa-paperclip"></i></h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark"
                                       href="{% url 'mogoon-fertilizer_table_update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter Fertilizer <i class="fa fa-calendar-check-o"
                                                                    aria-hidden="true"></i></h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class=" col-md-2">
                                    <a class="text-decoration-none text-dark"
                                       href="{% url 'mogoon-milk_table_update' %}">
                                        <div class="card my-card shadow text-center p-2">
                                            <h5>Enter Milk <i class="fa fa-calendar-check-o"
                                                              aria-hidden="true"></i></h5>
                                            <h4></h4>
                                        </div>
                                    </a>
                                </div>
                                <div class="card">
                                    <div class="card-header bg-light text-dark">
                                        Farm Graphs
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container fluid bg-white text-secondary my-0 px-0 mb-0 mt-0 border" style=" border-radius: 20px;">
            <h1>Graphs</h1>

            <div class="row my-5">
                <div class="md-4">
                    <div class="container my-0 mx-0 mt-1">
                        <div class="row mt-1">
                            <div class=" col-md-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="row">
                                                {% for model_name, data_and_form in data_and_forms.items %}
                                                <div class="col-md-4">
                                                    <div class="bg-white">
                                                        <canvas id="{{ model_name|lower }}Chart"
                                                                style="height: 400px;"></canvas>
                                                        <script>
                                                            // Ensure jQuery is noConflict mode to avoid conflicts
                                                            jQuery.noConflict();

                                                            jQuery(document).ready(function ($) {
                                                                // Function to extract data from the table and generate a chart
                                                                function generateChart() {
                                                                    var labels = [{% for data in data_and_form.data %}
                                                                    '{{ data.department }}',
                                                                    '{{ data.plucking_date }}',
                                                                    '{{ data.plucking_date }}',
                                                                    '{{ data.pruning_done }}',
                                                                    '{{ data.weeding_done }}',
                                                                    '{{ data.fertilizer_applied }}',
                                                                    '{{ data.milking_done }}',
                                                                    '{{ data.calf_down }}',
                                                                    {% endfor %}];

                                                                    var values = [{% for data in data_and_form.data %}
                                                                                                        {{ data.salary_total }},
                                                                                                        {{ data.green_today }},
                                                                                                        {{ data.purple_today }},
                                                                                                        {{ data.pruned_bushes }},
                                                                                                        {{ data.weeding_cost }},
                                                                                                        {{ data.fertilizer_amt }},
                                                                                                        {{ data.milk_today }},
                                                                                                        {{ data.vet_cost }},
                                                                                                  {% endfor %}];

                                                                    // Define different colors for each bar
                                                                            var backgroundColors = [
                                                                                'rgba(75, 192, 192, 1)',
                                                                                'rgba(255, 99, 132, 1)',
                                                                                'rgba(255, 205, 86, 1)',
                                                                                'rgba(54, 162, 235, 1)',
                                                                                'rgba(255, 199, 232, 1)',
                                                                                'rgba(255, 20, 86, 1)',
                                                                                'rgba(54, 62, 135, 1)',
                                                                                // Add more colors as needed
                                                                            ];

                                                                            // Define border colors for each bar
                                                                            var borderColors = [
                                                                                'rgba(75, 192, 192, 1)',
                                                                                'rgba(255, 99, 132, 1)',
                                                                                'rgba(255, 205, 86, 1)',
                                                                                'rgba(54, 162, 235, 1)',
                                                                                'rgba(255, 199, 232, 1)',
                                                                                'rgba(255, 20, 86, 1)',
                                                                                'rgba(54, 62, 135, 1)',
                                                                                // Add more colors as needed
                                                                            ];

                                                                    // Chart.js configuration
                                                                    var ctx = document.getElementById('{{ model_name|lower }}Chart').getContext('2d');
                                                                    var myChart = new Chart(ctx, {
                                                                        type: 'bar',
                                                                        data: {
                                                                            labels: labels,
                                                                            datasets: [{
                                                                                label: '{{ model_name }}',
                                                                                data: values,
                                                                                backgroundColor: backgroundColors,
                                                                                borderColor: borderColors,
                                                                                borderWidth: 1
                                                                            }]
                                                                        },
                                                                        options: {
                                                                            scales: {
                                                                                y: {
                                                                                    beginAtZero: true
                                                                                }
                                                                            }
                                                                        }
                                                                    });
                                                                }

                                                                // Call the function to generate the chart
                                                                generateChart();
                                                            });

                                                        </script>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            </div>


                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--end-graphs>-->
                            {% endblock %}







